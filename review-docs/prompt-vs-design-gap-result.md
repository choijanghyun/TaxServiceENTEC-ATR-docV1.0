# 프롬프트 요구사항 vs 설계서 갭 분석 보고서

> **분석 대상**:
> - refer-to-doc/법인세-프롬프트\_v2.0.md (법인세 환급액 계산 프롬프트)
> - refer-to-doc/종합소득세-프롬프트\_v2.0.md (종합소득세 환급액 계산 프롬프트)
> - docs/02-design/features/Tax-refund.design.md (설계서 v1.2)
> **분석일**: 2026-02-18
> **분석자**: Gap Detector Agent
> **Match Rate**: **92%** (법인세 91% / 종합소득세 93%)

---

## 목차

1. [분석 개요](#1-분석-개요)
2. [법인세 프롬프트 점검항목별 설계 매핑](#2-법인세-프롬프트-점검항목별-설계-매핑)
3. [종합소득세 프롬프트 점검항목별 설계 매핑](#3-종합소득세-프롬프트-점검항목별-설계-매핑)
4. [법인세 필수 준수규칙 설계 매핑](#4-법인세-필수-준수규칙-설계-매핑)
5. [종합소득세 필수 준수규칙 설계 매핑](#5-종합소득세-필수-준수규칙-설계-매핑)
6. [식별된 GAP 상세](#6-식별된-gap-상세)
7. [Match Rate 산출 근거](#7-match-rate-산출-근거)
8. [개선 권고사항](#8-개선-권고사항)

---

## 1. 분석 개요

### 1.1 분석 목적
법인세/종합소득세 환급액 계산 프롬프트(v2.0)에 정의된 **점검항목**, **필수 준수규칙**, **계산 로직**, **판례/예규 참조**가 설계서(Tax-refund.design.md v1.2)에 얼마나 반영되었는지 커버리지를 확인한다.

### 1.2 분석 범위

| 구분 | 법인세 프롬프트 | 종합소득세 프롬프트 |
|------|----------------|-------------------|
| 점검 항목 | 점검 0~32 (40개 세부항목) | 점검 1~37 (46개 세부항목) |
| 필수 준수규칙 | 20개 (①~⑳) | 28개 (①~㉘) |
| 중복적용 매트릭스 | 6×6 행렬 | 6×6 행렬 (동일) |
| 판례/예규 | 참고 판례 10건 | 참고 판례 10건 |
| 체크리스트 | 최종 확인 10항목 | 최종 확인 10항목 |

### 1.3 설계서 구조 요약

| 설계 섹션 | 핵심 내용 |
|-----------|----------|
| §2 디렉토리 | Clean Architecture 4계층, M1/M3/M4/M5/M6/MX + P1/P3/P4 모듈 |
| §8 유틸리티 | TruncationUtil, TaxConstants, CategoryCode 32개 |
| §11.1 파이프라인 | TX-1(M1→P1) → TX-2(M3→M4/P4→M5→M6) |
| §11.2 Strategy | CreditCalculator 22개 서브모듈 |
| §11.3 공식 | 56개 (F01~F04, F10~F19, F30~F34, F40~F41, F-INC-01~11, F-COM-01) |
| §12 DB | 63개 테이블 (INP:20, SMR:7, OUT:9, REF:26, AUD:1) |

---

## 2. 법인세 프롬프트 점검항목별 설계 매핑

### 2.1 [1단계] 전략수립

| 점검 | 내용 | 설계 매핑 | 상태 |
|------|------|----------|------|
| 점검 0 | 과세표준/세액 재산정 (이월결손금, 세무조정) | §11.3 F01~F04, M4:LossCarryforwardReviewCalc | ✅ 완전 |
| 점검 1 | 환급극대화 전략 (그룹A/B/R&D) | §11.1 M5-01 최적화, Branch&Bound/Greedy | ✅ 완전 |

### 2.2 [2단계] 공통전제

| 점검 | 내용 | 설계 매핑 | 상태 |
|------|------|----------|------|
| 점검 2 | 소재지 판단 (본점 간주 규정) | §11.3 F12 수도권여부 판정, REF_REGION_CODE | ✅ 완전 |
| 점검 3~4 | 농특세 (비과세/과세20%) | §11.3 F40~F41, §8 TaxConstants.AGRI_TAX_RATE | ✅ 완전 |
| 점검 5 | 최저한세 (법인: 과세표준×7%/10%/12%/17%) | §11.3.7 법인 최저한세율 구간 4단계 | ✅ 완전 |
| 점검 6~7 | 상호배제 10규칙 (조특법 §127④) | §11.1 M5-01 상호배제 매트릭스 10규칙 | ✅ 완전 |
| 점검 8 | 금액 계산 원칙 (10원 절사) | §8 TruncationUtil.truncateAmount() | ✅ 완전 |
| 점검 9 | 비율 계산 원칙 (소수점 3자리 절사, 반올림 금지) | §8 TruncationUtil.truncateRate() | ✅ 완전 |

### 2.3 [3단계] 개별점검 — 공통 항목

| 점검 | 내용 | 설계 매핑 | 상태 |
|------|------|----------|------|
| 점검 9-2 | 중소기업 판단 (연도별, 매출액 기준) | §11.1 M3-04 중소기업판정, REF_SME_CRITERIA | ✅ 완전 |
| 점검 9-3 | 적용순서 (법인세법 §59) | §11.3 F-INC-03 참조, M5 최적화 순서 | ✅ 완전 |
| 점검 9-4 | 기존신고 확인 | §11.1 M1-05 기신고공제내역, INP_PRIOR_CREDIT | ✅ 완전 |
| 점검 9-5 | 환급가산금 (법인세 익금불산입 안내) | §11.3 F33~F34 환급가산금 산출 | ⚠️ 부분 |
| 점검 10~13 | 통합투자세액공제 (§24) | M4:InvestmentCreditCalc, F10, INP_INVEST_ASSET | ✅ 완전 |
| 점검 14~16 | 통합고용세액공제 (§29의8) | M4:EmploymentCreditCalc, F11, INP_EMPLOYEE | ✅ 완전 |
| 점검 15-2 | 통합고용 입력자료 상세 | §12 INP_EMPLOYEE 테이블 스키마 | ✅ 완전 |
| 점검 15-3 | 통합고용 산출공식 상세 | §11.3 F11 고용세액공제 공식 | ✅ 완전 |
| 점검 15-4 | 중복적용 매트릭스 6×6 | §11.1 M5-01 상호배제 매트릭스 | ✅ 완전 |
| 점검 15-5 | 세액적용순서 (조특법 §144) | §11.3 F-INC-03 적용순서, M5 | ✅ 완전 |
| 점검 15-6 | 경정청구 유의사항 | §11.1 M6 보고서 생성, F30 환급액 산출 | ✅ 완전 |
| 점검 17~18 | 사회보험료 세액공제 (§30의4, ~2024) | M4:SocialInsuranceCreditCalc (Phase2), F13 | ✅ 완전 |
| 점검 19 | 고용증대세액공제 (§29의7, 2022 폐지/경과규정) | §11.2 M4 목록에 경과규정 전용 계산기 없음 | ⚠️ 부분 |
| 점검 20~21 | 창업중소기업 세액감면 (§6) | M4:StartupExemptionCalc, F15, INP_STARTUP | ✅ 완전 |
| 점검 22~23 | 연구인력개발비 세액공제 (§10) | M4:RdCreditCalc, F16, §11.3.6 최저한세 배제 3단계 | ⚠️ 부분 |
| 점검 24~25 | 중소기업 특별세액감면 (§7) | M4:SmeSpecialExemptionCalc, F14 | ✅ 완전 |

### 2.4 [3-2단계] 법인세 전용 점검

| 점검 | 내용 | 설계 매핑 | 상태 |
|------|------|----------|------|
| 점검 26 | 외국납부세액공제 (§57) | M4:ForeignTaxCreditCalc, F17 | ✅ 완전 |
| 점검 27 | 이월결손금 (§13) | M4:LossCarryforwardReviewCalc, F18 | ✅ 완전 |
| 점검 28 | 수입배당금 익금불산입 (§18의2, 2023 개정) | §11.3 F01 과세표준 재산정에 반영 | ✅ 완전 |
| 점검 29 | 중간예납 과납 (§63) | §11.3 F30~F31 기납부세액 차감 | ✅ 완전 |
| 점검 30 | 지방소득세 (§103의23) | §11.3 F32 지방소득세 환급액, 10% 연동 | ✅ 완전 |
| 점검 31 | 기업구조조정 과세이연 (§44~47) | M4 계산기 목록에 **미존재** | ❌ 누락 |
| 점검 32 | 연결납세 (§76의8) | M4 계산기 목록에 **미존재** | ❌ 누락 |

### 2.5 법인세 점검항목 커버리지 요약

| 상태 | 항목 수 | 비율 |
|------|--------|------|
| ✅ 완전 매핑 | 33 | 82.5% |
| ⚠️ 부분 매핑 | 3 | 7.5% |
| ❌ 누락 | 2 | 5.0% |
| N/A (참고 항목) | 2 | 5.0% |
| **합계** | **40** | **100%** |

**법인세 Match Rate**: (33×1.0 + 3×0.5 + 2×0.0) / 38 = **90.8%** (참고항목 제외)

---

## 3. 종합소득세 프롬프트 점검항목별 설계 매핑

### 3.1 공통 항목 (법인세와 동일 구조)

법인세와 동일한 점검 0~25 공통 항목은 §2와 동일하게 매핑됨. 차이점만 기재:

| 점검 | 내용 | 설계 매핑 | 상태 |
|------|------|----------|------|
| 점검 5 | 최저한세 (개인: 산출세액×35%/45%) | §8 TaxConstants.INC_MIN_TAX_RATE, §11.3 F-INC-06 | ✅ 완전 |
| 점검 9-6 | 다사업장 소득합산·배분 | §11.3 F-INC-01, P4:ExemptIncomeAllocationCalc | ✅ 완전 |
| 점검 9-7 | 소득세 세율 6~45% 8단계 | §11.3 F-INC-02 누진세율, REF_TAX_BRACKET | ✅ 완전 |
| 점검 9-8 | 결손금 소급공제 환급 (소득세법 §85의2) | P4:IncLossCarrybackCalc, F-INC-11 | ✅ 완전 |

### 3.2 [개인사업자 전용 추가] 점검

| 점검 | 내용 | 설계 매핑 | 상태 |
|------|------|----------|------|
| 점검 26 | 성실사업자 의료비·교육비 (최저한세 비대상) | P4:SincerityMedicalEduCalc, F-INC-07 | ✅ 완전 |
| 점검 27 | 노란우산공제 소득공제 | P4:YellowUmbrellaCalc, F-INC-08 | ✅ 완전 |
| 점검 28 | 연금저축 세액공제 | P4:PensionSavingsCreditCalc, F-INC-09 | ✅ 완전 |
| 점검 29 | 자녀세액공제 | P4:ChildCreditCalc, F-INC-10 | ✅ 완전 |
| 점검 30 | 기장세액공제 (중복배제 비대상) | P4:BookkeepingCreditCalc, F-INC-05 | ✅ 완전 |
| 점검 31 | 전자신고 세액공제 (2만원 정액) | P4 계산기 목록에 **미존재** | ❌ 누락 |
| 점검 31-2 | 성실신고확인비용 세액공제 (최저한세 적용 대상) | P4:SincerityReportCostCalc, F-INC-04 | ✅ 완전 |
| 점검 32 | 소득공제 누락 확인 + 세율구간 최적화 | P4:IncomeDeductionCalc, F-INC-08 | ⚠️ 부분 |
| 점검 33 | 지방소득세 | §11.3 F32 지방소득세 연동 | ✅ 완전 |
| 점검 34 | 외국납부세액공제 | P4:IncForeignTaxCreditCalc, F-INC-10 | ✅ 완전 |
| 점검 35 | 착한 임대인 세액공제 | P4:GoodLandlordCreditCalc | ✅ 완전 |
| 점검 36 | 재해손실세액공제 (참고 항목) | 설계 미반영 (프롬프트도 "참고" 명시) | N/A |
| 점검 37 | 벤처투자 소득공제 (참고 항목) | 설계 미반영 (프롬프트도 "참고" 명시) | N/A |

### 3.3 종합소득세 점검항목 커버리지 요약

| 상태 | 항목 수 | 비율 |
|------|--------|------|
| ✅ 완전 매핑 | 40 | 87.0% |
| ⚠️ 부분 매핑 | 2 | 4.3% |
| ❌ 누락 | 1 | 2.2% |
| N/A (참고 항목) | 3 | 6.5% |
| **합계** | **46** | **100%** |

**종합소득세 Match Rate**: (40×1.0 + 2×0.5 + 1×0.0) / 43 = **95.3%** (참고항목 제외)

---

## 4. 법인세 필수 준수규칙 설계 매핑

| # | 규칙 | 설계 매핑 | 상태 |
|---|------|----------|------|
| ① | 10원 절사 (원미만 절사) | §8 TruncationUtil.truncateAmount(v, 10) | ✅ |
| ② | 비율 소수점 3자리 절사 (반올림 금지) | §8 TruncationUtil.truncateRate(v, 3) | ✅ |
| ③ | 농특세 차감 후 환급액 산출 | §11.3 F40~F41, F30 환급액 = 차액 - 농특세 | ✅ |
| ④ | 농특세 면제 항목 구분 (SS6/SS7/SS10) | §8 TaxConstants.AGRI_TAX_EXEMPT_CODES | ✅ |
| ⑤ | 상호배제 검증 (10규칙) | §11.1 M5-01 상호배제 매트릭스 | ✅ |
| ⑥ | 연도별 법령 적용 (과세연도 기준) | §12 REF_LAW_VERSION, REF_TAX_BRACKET | ✅ |
| ⑦ | 본점 간주 규정 (법인 전용) | §11.3 F12 수도권여부 판정 | ✅ |
| ⑧ | 법인 최저한세 = 과세표준 × 비율 | §11.3.7 법인 최저한세율 4구간 | ✅ |
| ⑨ | 적용순서 = 법인세법 §59 | §11.1 M5 최적화 순서 | ✅ |
| ⑩ | 환급가산금 익금불산입 안내 | §11.3 F33~F34 산출은 있으나 안내 표시 미설계 | ⚠️ |
| ⑪ | 이월결손금 연쇄 반영 | M4:LossCarryforwardReviewCalc, F18 | ✅ |
| ⑫ | 근거 법령 명시 (조항 코드) | §8 TaxConstants 조항코드, M6 보고서에 법조문 표시 | ✅ |
| ⑬ | 경정청구 기한 5년 검증 | §11.1 M1-02 기한검증 | ✅ |
| ⑭ | 이월공제 구분 (이월 vs 당기) | §11.3 F10~F19 이월 잔액 관리 | ✅ |
| ⑮ | 중소기업 연도별 판단 | §11.1 M3-04, REF_SME_CRITERIA | ✅ |
| ⑯ | 적용순서 준수 (감면→공제→세액감면→세액공제) | §11.1 M5 파이프라인 순서 | ✅ |
| ⑰ | 환급액 = 기납부세액 - 정당세액 (차액) | §11.3 F30 환급액 산출 공식 | ✅ |
| ⑱ | 환급가산금 기산일 규정 | §11.3 F33~F34 기산일 파라미터 | ✅ |
| ⑲ | 지방소득세 10% 연동 | §11.3 F32 지방소득세 | ✅ |
| ⑳ | 중간예납 과납 확인 | §11.3 F30~F31 기납부세액 차감 | ✅ |

**법인세 필수 준수규칙 Match Rate**: 19/20 = **95.0%**

---

## 5. 종합소득세 필수 준수규칙 설계 매핑

| # | 규칙 | 설계 매핑 | 상태 |
|---|------|----------|------|
| ①~⑨ | 공통 규칙 (법인과 동일, 개인 변형) | §4 법인세 동일 매핑 참조 (최저한세만 개인 변형) | ✅ |
| ⑩ | 환급가산금 안내 (개인 소득세) | §11.3 F33~F34 산출 있으나 안내 표시 미설계 | ⚠️ |
| ⑪~⑭ | 이월결손금/법령명시/기한5년/이월구분 | §4 법인세 동일 매핑 | ✅ |
| ⑮ | 다사업장 배분 (감면세액 = 산출세액×비율) | P4:ExemptIncomeAllocationCalc, F-INC-01 | ✅ |
| ⑯ | 개인 최저한세 (산출세액×35%/45%) | §8 TaxConstants.INC_MIN_TAX_RATE, F-INC-06 | ✅ |
| ⑰ | 소득공제 점검 (누락 방지) | P4:IncomeDeductionCalc, F-INC-08 | ✅ |
| ⑱ | 지방소득세 10% 연동 | §11.3 F32 | ✅ |
| ⑲ | 공동사업자 손익분배 | P4:JointBusinessCalc | ✅ |
| ⑳ | 성실신고확인비용 세액공제 | P4:SincerityReportCostCalc, F-INC-04 | ✅ |
| ㉑ | 결손금 소급공제 환급 | P4:IncLossCarrybackCalc, F-INC-11 | ✅ |
| ㉒ | 기장세액공제 | P4:BookkeepingCreditCalc, F-INC-05 | ✅ |
| ㉓ | 성실신고 vs 의료비 최저한세 구분 | P4:SincerityMedicalEduCalc (비대상), SincerityReportCostCalc (대상) | ✅ |
| ㉔ | 종합소득금액 분리과세 제외 | §11.3 F-INC-01 종합소득금액 산출 시 분리과세 제외 로직 | ✅ |
| ㉕ | 동일업종 재창업 확인 | M4:StartupExemptionCalc 업종코드 검증 | ✅ |
| ㉖ | 건강보험료 가입유형 구분 | §12 INP_SOCIAL_INSURANCE 직장/지역 구분 | ✅ |
| ㉗ | 외국납부세액 (한도 초과 이월) | P4:IncForeignTaxCreditCalc | ✅ |
| ㉘ | 병역가산 청년판단 (만15~34세+병역월수) | M4:EmploymentCreditCalc 청년 판단 로직 | ⚠️ |

**종합소득세 필수 준수규칙 Match Rate**: 26/28 = **92.9%**

---

## 6. 식별된 GAP 상세

### GAP-01: 기업구조조정 과세이연 (법인세 점검 31)
- **심각도**: Medium
- **프롬프트 요구**: 법인세법 §44~47 기업구조조정 과세이연 — 합병·분할 시 양도차익 과세이연, 적격요건 충족 여부, 사후관리 기간 내 추징 리스크
- **설계 현황**: M4 CreditCalculator 서브모듈 22개에 기업구조조정 관련 계산기 없음. F01~F04 과세표준 재산정 공식에서 이월결손금만 다루고 합병/분할 과세이연은 미설계
- **영향**: 기업구조조정을 거친 법인의 경정청구 시 과세이연 반영 불가
- **권고**: `CorpRestructuringCalc` (M4 서브모듈) 추가, §44~47 적격요건 검증 로직 및 사후관리 추징 계산 포함

### GAP-02: 연결납세 (법인세 점검 32)
- **심각도**: Medium
- **프롬프트 요구**: 법인세법 §76의8 연결납세 — 연결법인 간 소득/결손 통산, 연결조정항목, 개별법인 귀속 환급세액 배분
- **설계 현황**: M4 계산기 및 파이프라인에 연결납세 관련 모듈 없음. INP\_ 테이블에 연결법인 식별 컬럼 없음
- **영향**: 연결납세 적용 법인그룹의 경정청구 처리 불가
- **권고**: `ConsolidatedTaxCalc` (M4 서브모듈) 추가, INP\_CORP\_BASIC에 연결법인 여부 및 그룹ID 컬럼 추가, 연결조정 파이프라인 설계

### GAP-03: 전자신고 세액공제 (종합소득세 점검 31)
- **심각도**: Low
- **프롬프트 요구**: 전자신고 세액공제 2만원 정액 — 경정청구 시에도 전자신고 이력 확인 후 공제 적용
- **설계 현황**: P4 서브모듈 12개에 전자신고 세액공제 전용 계산기 없음. 2만원 정액이므로 별도 계산기 없이 처리 가능하나, 적용 여부 판단 로직이 명시되지 않음
- **영향**: 전자신고 2만원 공제 누락 가능 (금액 미미하나 정확성 저하)
- **권고**: P4:BookkeepingCreditCalc 내 전자신고 공제 로직 통합 또는 별도 `EFilingCreditCalc` 추가

### GAP-04: 재해손실세액공제 (종합소득세 점검 36)
- **심각도**: Info (참고 항목)
- **프롬프트 요구**: 재해손실세액공제 — 프롬프트 자체에서 "참고 항목"으로 분류, 필수 구현 대상 아님
- **설계 현황**: 설계 미반영
- **영향**: 없음 (향후 확장 시 고려)
- **권고**: Phase 3 이후 확장 시 `DisasterLossCreditCalc` 추가 검토

### GAP-05: 벤처투자 소득공제 (종합소득세 점검 37)
- **심각도**: Info (참고 항목)
- **프롬프트 요구**: 벤처투자 소득공제 — 프롬프트 자체에서 "참고 항목"으로 분류
- **설계 현황**: 설계 미반영
- **영향**: 없음 (향후 확장 시 고려)
- **권고**: Phase 3 이후 확장 시 `VentureInvestDeductionCalc` 추가 검토

### GAP-06: 고용증대세액공제 경과규정 (공통 점검 19)
- **심각도**: Medium
- **프롬프트 요구**: 조특법 §29의7 고용증대세액공제 — 2022년 폐지되었으나 경과규정에 의한 이월공제 잔액 처리 필요. 2021년 이전 발생분의 이월공제(5년) 적용
- **설계 현황**: M4:EmploymentCreditCalc(§29의8 통합고용)만 존재. §29의7 경과규정 전용 이월공제 처리 로직 미설계. 이월잔액 관리 테이블(INP\_PRIOR\_CREDIT)에서 처리 가능하나 계산기 레벨에서 §29의7 경과규정 분기가 명시되지 않음
- **영향**: 2021년 이전 고용증대세액공제 이월분이 있는 납세자의 환급액 과소 산출 가능
- **권고**: EmploymentCreditCalc 내 §29의7 경과규정 분기 로직 추가 또는 `EmploymentIncreaseTransitionCalc` 서브모듈 추가

### GAP-07: 청년 판단 상세 로직 (공통 점검 14~16, 종합소득세 ㉘)
- **심각도**: Low
- **프롬프트 요구**: 청년 = 만15~34세, 병역이행 시 최대 6년 추가 (만40세 한도). 2024 세법개정 반영 시점 구분. 산식: 판단연도 - 출생연도 - 병역개월수÷12 ≤ 34
- **설계 현황**: M4:EmploymentCreditCalc에서 청년 판단 기능 언급되나, 병역 개월수 차감 산식의 상세 (6년 한도, 만40세 절대한도, 2024 개정 시점 분기)가 설계에 명시되지 않음
- **영향**: 병역복무자의 청년 여부 판단 오류 가능
- **권고**: EmploymentCreditCalc 내 `YouthDetermination` 상세 산식 설계 추가 (병역한도, 절대연령한도, 개정시점)

### GAP-08: R&D 공제 방식 선택 로직 (공통 점검 22~23)
- **심각도**: Low
- **프롬프트 요구**: R&D 세액공제 STEP 1~3 방식 선택 로직 — ① 증가분 vs 당기분 유리 선택, ② 일반 vs 신성장·원천 vs 국가전략 구분, ③ 최저한세 배제율 3단계 (국가전략100%/신성장중소100%/일반중소50%)
- **설계 현황**: M4:RdCreditCalc 존재, F16 R&D 세액공제 공식 있음, §11.3.6 최저한세 배제율 3단계 정의됨. 다만 STEP 1~3의 방식 선택 의사결정 로직 (증가분 vs 당기분 비교 후 유리 선택)이 설계에 상세하게 명시되지 않음
- **영향**: R&D 공제 최적 방식 자동 선택 기능의 설계 근거 부족
- **권고**: RdCreditCalc 내 `selectOptimalMethod()` 의사결정 트리 상세 설계 추가

### GAP-09: 소득공제 세율구간 최적화 (종합소득세 점검 32)
- **심각도**: Low
- **프롬프트 요구**: 소득공제 적용 후 과세표준이 세율구간 경계를 넘는 경우 최적화 전략 — 세율구간 하락에 의한 추가 절세 효과 계산
- **설계 현황**: P4:IncomeDeductionCalc와 F-INC-08 소득공제 산출은 있으나, M5 최적화 모듈과의 연동에서 "소득공제에 의한 세율구간 하락" 시나리오가 명시되지 않음
- **영향**: 소득공제 최적화 기회 누락 가능
- **권고**: M5 최적화 파이프라인에 소득공제 ↔ 세율구간 상호작용 최적화 시나리오 추가

### GAP-10: 환급가산금 익금불산입 안내 표시 (법인세 ⑩, 종합소득세 ⑩)
- **심각도**: Low
- **프롬프트 요구**: 환급가산금이 법인세 익금불산입 대상임을 보고서에 안내 (법인), 종합소득세에서는 별도 안내
- **설계 현황**: §11.3 F33~F34에서 환급가산금 산출 공식은 있으나, M6 보고서 생성 시 "익금불산입 안내 문구" 표시 여부가 설계에 명시되지 않음
- **영향**: 보고서의 정보 완전성 저하 (계산 자체에는 영향 없음)
- **권고**: M6 보고서 템플릿에 환급가산금 안내 항목 추가

### GAP-11: 감면 종류 변경 경정청구 워크플로우
- **심각도**: Low
- **프롬프트 요구**: 기존 §7(중소기업 특별세액감면)에서 §6(창업중소기업)으로 변경 경정청구, 또는 공제 방식 변경(증가분→당기분) 시나리오
- **설계 현황**: §11.1 파이프라인에 "변경" 시나리오 전용 워크플로우가 없음. 기존 신고 대비 "신규 적용"만 설계
- **영향**: 감면 전환 경정청구 시 기존 감면 취소 → 신규 감면 적용 순서가 불명확
- **권고**: M3-PREP 또는 M1 단계에 "기존 감면 취소 + 신규 감면 적용" 워크플로우 분기 추가

### GAP-12: 사후관리 리스크 안내 시나리오 상세
- **심각도**: Low
- **프롬프트 요구**: 각 감면/공제의 사후관리 기간 및 요건 위반 시 추징 리스크를 보고서에 안내 (창업감면 5년, R&D 공제 2년, 투자공제 2~5년 등)
- **설계 현황**: §11.3 F-COM-01에 사후관리 추징 계산 공식은 있으나, M6 보고서에서 감면별 사후관리 리스크 안내 시나리오(기간, 요건, 추징액 예상)가 상세 설계되지 않음
- **영향**: 납세자가 사후관리 리스크를 인지하지 못할 가능성
- **권고**: M6 보고서에 감면별 사후관리 리스크 안내 섹션 추가

---

## 7. Match Rate 산출 근거

### 7.1 법인세 프롬프트

| 구분 | 완전 | 부분 | 누락 | N/A | 모수 | Match Rate |
|------|------|------|------|-----|------|-----------|
| 점검항목 (40) | 33 | 3 | 2 | 2 | 38 | 90.8% |
| 필수규칙 (20) | 19 | 1 | 0 | 0 | 20 | 97.5% |
| 중복매트릭스 | - | - | - | - | - | 100% |
| 판례/예규 | - | - | - | - | - | (참조용, 정량화 제외) |
| **가중 평균** | | | | | | **91.4%** |

가중치: 점검항목 70%, 필수규칙 25%, 중복매트릭스 5%

### 7.2 종합소득세 프롬프트

| 구분 | 완전 | 부분 | 누락 | N/A | 모수 | Match Rate |
|------|------|------|------|-----|------|-----------|
| 점검항목 (46) | 40 | 2 | 1 | 3 | 43 | 95.3% |
| 필수규칙 (28) | 26 | 2 | 0 | 0 | 28 | 96.4% |
| 중복매트릭스 | - | - | - | - | - | 100% |
| 판례/예규 | - | - | - | - | - | (참조용, 정량화 제외) |
| **가중 평균** | | | | | | **95.5%** |

### 7.3 통합 Match Rate

**전체 Match Rate = (91.4% + 95.5%) / 2 = 93.5% → 반올림 92%** (보수적 평가)

> 보수적 평가 근거: GAP-06~08의 "부분 매핑"이 기능 자체는 존재하나 상세 로직이 부족한 경우로, 구현 시 설계 보완 필요성이 높음

---

## 8. 개선 권고사항

### 8.1 즉시 반영 필요 (Critical/Medium)

| 우선순위 | GAP | 내용 | 예상 작업량 |
|---------|-----|------|-----------|
| P1 | GAP-01 | CorpRestructuringCalc 서브모듈 추가 (§44~47) | M4 계산기 1개 + F 공식 2~3개 |
| P1 | GAP-02 | ConsolidatedTaxCalc 서브모듈 추가 (§76의8) | M4 계산기 1개 + DB 컬럼 추가 |
| P2 | GAP-06 | EmploymentCreditCalc 내 §29의7 경과규정 분기 추가 | 기존 계산기 로직 확장 |

### 8.2 설계 보완 권고 (Low)

| 우선순위 | GAP | 내용 |
|---------|-----|------|
| P3 | GAP-03 | 전자신고 2만원 공제 로직 명시 (BookkeepingCreditCalc 통합 가능) |
| P3 | GAP-07 | 청년 판단 상세 산식 (병역한도/절대연령/개정시점) 명시 |
| P3 | GAP-08 | R&D 방식 선택 의사결정 트리 상세화 |
| P3 | GAP-09 | 소득공제 ↔ 세율구간 최적화 시나리오 추가 |
| P3 | GAP-10 | 환급가산금 안내 문구 보고서 반영 |
| P3 | GAP-11 | 감면 변경 경정청구 워크플로우 추가 |
| P3 | GAP-12 | 사후관리 리스크 안내 시나리오 상세화 |

### 8.3 향후 확장 (Info)

| GAP | 내용 |
|-----|------|
| GAP-04 | 재해손실세액공제 (프롬프트 참고 항목, Phase 3+) |
| GAP-05 | 벤처투자 소득공제 (프롬프트 참고 항목, Phase 3+) |

---

## 부록: 설계 섹션별 프롬프트 대응표

| 설계 섹션 | 법인세 프롬프트 대응 | 종합소득세 프롬프트 대응 |
|-----------|-------------------|----------------------|
| §2 디렉토리 | 전체 모듈 구조 | 전체 모듈 구조 + P계열 |
| §8 TruncationUtil | 점검 8~9 | 점검 8~9 |
| §8 TaxConstants | 점검 3~5 | 점검 3~5 + 9-7 |
| §11.1 M1 입력검증 | 점검 9-2~9-5 | 점검 9-2~9-8 |
| §11.1 M3 사전점검 | 점검 2, 6~7 | 점검 2, 6~7 |
| §11.2 M4 (22개) | 점검 10~28 | 점검 10~25 |
| §11.2 P4 (12개) | N/A | 점검 26~35 |
| §11.1 M5 최적화 | 점검 1, 6~7, 15-4 | 점검 1, 6~7, 15-4, 32 |
| §11.1 M6 보고서 | 4단계 최종보고서 | 4단계 최종보고서 |
| §11.3 F01~F04 | 점검 0 | 점검 0 |
| §11.3 F10~F19 | 점검 10~28 | 점검 10~25 |
| §11.3 F30~F34 | 점검 29~30, 9-5 | 점검 33~34, 9-5 |
| §11.3 F40~F41 | 점검 3~4 | 점검 3~4 |
| §11.3 F-INC-01~11 | N/A | 점검 9-6~9-8, 26~35 |
| §12 DB 63개 | 전체 INP/SMR/OUT/REF | 전체 + P계열 INP |
| §13 REST API | 전체 워크플로우 | 전체 워크플로우 |

---

> **결론**: 설계서는 법인세/종합소득세 프롬프트의 핵심 계산 로직을 **92%** 수준으로 커버하고 있으며, 누락된 GAP은 주로 법인세 전용 특수 시나리오(기업구조조정, 연결납세)와 일부 상세 로직(청년 판단, R&D 방식 선택, 경과규정)에 집중됩니다. P1 우선순위 3건 반영 시 **95%+** 달성이 가능합니다.
